utility function for version3